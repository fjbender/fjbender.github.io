<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Multiple Webhook Urls in One Payment or Order - I drink and I know things</title><meta name=Description content="A collection of random knowledge"><meta property="og:title" content="Multiple Webhook Urls in One Payment or Order"><meta property="og:description" content="Multiple Webhook URLs in One Payment or Order The problem for merchants Sometimes, a merchant wants to inform multiple systems about the status changes (or the inception) of a payment (or order - we use payment synonymously throughout this article).
For instance, the merchant might use a SaaS Order Management System (OMS) and Shopware 6. Whenever a new payment reaches the state of paid, the merchant wants this information to go into their SaaS OMS, where they then pull the payment and use the information in the metadata field to pull the order from the Shopware API."><meta property="og:type" content="article"><meta property="og:url" content="https://idaikt.sporkify.net/multiple-webhook-urls-in-one-payment-or-order/"><meta property="og:image" content="https://idaikt.sporkify.net/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-17T08:37:09+01:00"><meta property="article:modified_time" content="2023-01-19T10:57:10+01:00"><meta property="og:site_name" content="I drink and I know things"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://idaikt.sporkify.net/logo.png"><meta name=twitter:title content="Multiple Webhook Urls in One Payment or Order"><meta name=twitter:description content="Multiple Webhook URLs in One Payment or Order The problem for merchants Sometimes, a merchant wants to inform multiple systems about the status changes (or the inception) of a payment (or order - we use payment synonymously throughout this article).
For instance, the merchant might use a SaaS Order Management System (OMS) and Shopware 6. Whenever a new payment reaches the state of paid, the merchant wants this information to go into their SaaS OMS, where they then pull the payment and use the information in the metadata field to pull the order from the Shopware API."><meta name=application-name content="I drink and I know things"><meta name=apple-mobile-web-app-title content="I drink and I know things"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://idaikt.sporkify.net/multiple-webhook-urls-in-one-payment-or-order/><link rel=prev href=https://idaikt.sporkify.net/replay-failed-webhook-calls/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Multiple Webhook Urls in One Payment or Order","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/idaikt.sporkify.net\/multiple-webhook-urls-in-one-payment-or-order\/"},"genre":"posts","wordcount":1037,"url":"https:\/\/idaikt.sporkify.net\/multiple-webhook-urls-in-one-payment-or-order\/","datePublished":"2023-01-17T08:37:09+01:00","dateModified":"2023-01-19T10:57:10+01:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Florian Bender, Savannah van Lit"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="I drink and I know things">I drink and I know things</a></div><div class=menu><div class=menu-inner><a class=menu-item href=https://github.com/fjbender/fjbender.github.io rel="noopener noreffer" target=_blank>Collaborate </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="I drink and I know things">I drink and I know things</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=https://github.com/fjbender/fjbender.github.io title rel="noopener noreffer" target=_blank>Collaborate</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Multiple Webhook Urls in One Payment or Order</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Florian Bender, Savannah van Lit</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-01-17>2023-01-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1037 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#the-problem-for-merchants>The problem for merchants</a></li><li><a href=#the-problem-for-technology-integrators>The problem for technology integrators</a></li><li><a href=#a-workable-solution-today>A workable solution (today)</a></li><li><a href=#a-workable-solution-tomorrow>A workable solution (tomorrow)</a></li></ul></nav></div></div><div class=content id=content><h1 id=multiple-webhook-urls-in-one-payment-or-order>Multiple Webhook URLs in One Payment or Order</h1><h2 id=the-problem-for-merchants>The problem for merchants</h2><p>Sometimes, a merchant wants to inform multiple systems about the status changes (or the inception) of a payment (or order - we use payment synonymously throughout this article).</p><p>For instance, the merchant might use a SaaS Order Management System (OMS) and Shopware 6. Whenever a new payment reaches the state of <code>paid</code>, the merchant wants this information to go into their SaaS OMS, where they then pull the payment and use the information in the <code>metadata</code> field to pull the order from the Shopware API. This approach is beneficial, because the merchant doesn&rsquo;t have to write complicated export logic in Shopware, but rather just pulls orders that definitively are paid.</p><p>This, however, does not work currently. The merchant might overwrite the <code>webhookUrlGenerator</code> component in the Shopware 6 plugin to divert webhooks to their SaaS OMS, but that would break a lot of functionality in Shopware, as the webhook is not available there anymore.</p><h2 id=the-problem-for-technology-integrators>The problem for technology integrators</h2><p>With the increasing focus on technology (SaaS) integrations, the restrictions caused by webhooks not calling to multiple platforms have become more obvious. Consequently, platforms not creating transactions are left without real-time updates on transactions, customers, subscriptions and more. Examples of platforms that need real-time data updates within the SaaS landscape are:</p><ul><li>Marketing Automation tools (Active Campaign, Klaviyo)</li><li>Workflow automation systems (Zapier, Make)</li><li>CRM-systems (Freshworks, Hubspot)</li></ul><p>At present, if we were to build a non-transaction creating Technology integration we would be forced to construct a (mirror) middleware database as a workaround. The needed Mollie data (transactions, customers etc.) would be stored within this data base. By means of the List function within our API the data would be updated every X amount of time, depending on the need of the integration.</p><p>Although this might be a temporary solution, this set up has the following drawbacks:</p><p>Increased Security risk - As we are currently not able to host the mirror data bases within Mollie we are obliged to host the databases with a third party (third party integrator or contractor of third party integrator). This set-up increases the risk of a data breach and therefore reputation risk of Mollie. &ldquo;Mitigation of this risk is executed carefully and diligently, but that uses time and resources and slows down the process.</p><p>No real-time updates - As the amount of data that is processed within a List request is too great to do an (almost) constant pull request, the requests are carried out within certain timeframes. Consequently, the data shown within the integration and possible actions depending on the changes of data will always have a lag.</p><p>Strenuous use of Mollie data base - Due to the fact that pulling targeted updates is not possible, we are compelled to update all available data via a List request. This results in unnecessary use of the Mollie data base.</p><p>Fall-off of historic data due to pagination - As the Mollie API employs Pagination with the List request, we are restricted to updates of the most recent 250 transactions within an organisation. This limits the quality of our integrations for larger customers.</p><h2 id=a-workable-solution-today>A workable solution (today)</h2><p>Enter <a href=https://github.com/fjbender/mwm2 target=_blank rel="noopener noreffer">MWM2</a>. MWM2 is the second iteration of the Mollie Webhook Multiplexer. It&rsquo;s a simple PHP/Symfony application, that reads in a configuration file containing a list of endpoints that should receive webhooks from Mollie. Users can configure whether path or query parameters should be preserved, and which HTTP Verb should be used (<code>POST</code> is very likely). The merchant then reconfigures the <code>webhookUrl</code> for their payments to point towards MWM2, and MWM2 clones and sends the webhooks to multiple systems described in the config file. The application is written in such a way that it&rsquo;s easily extendable, for instance if the user wants to manipulate URLs or webhook data according to other variables.</p><p>The application uses <a href=https://symfony.com/doc/current/messenger.html target=_blank rel="noopener noreffer">Symfony Messenger</a> to put webhooks into a RabbitMQ, Redis, SQL, or whatever queue so they don&rsquo;t need to be process synchronously (which considerably speeds up inbound webhook processing, and also ensures ultimate delivery, retries, and more for target systems). See the repository&rsquo;s <code>README.md</code> for details.</p><h2 id=a-workable-solution-tomorrow>A workable solution (tomorrow)</h2><p>The limitations described above can be solved by introducing a Hooks or Events API to our current API offering. Put simply, a Hooks API would list all events occurring within the Mollie account that would trigger a webhook. By subscribing to this endpoint, the merchant or partner will be able to detect all important updates within their account and build the necessary automations within their platform, instead of constantly pulling potentially empty endpoints. Additionally, a Hooks or Events API (similar to those of Stripe and Adyen) is not something new; looking at our competitors, we can consider this to be a market standard.</p><p>For the actual implementation within Mollie there are multiple possibilities. Here are a few examples:</p><ol><li><p><em>Events:</em>
An Events API will list all events within the Mollie account that would trigger a webhook. This API will list all events without any filtering from Mollie’s side. The event will contain parameters that will make it possible for the merchant to categorise. For example, a payment paid will generate a payment.paid. Using the events parameters, the customer is able to create customised pull requests or any business logic necessary.</p></li><li><p><em>Events with filtering on Mollie side:</em>
Similar to the permission scope settings that can be created within the Mollie dashboard, the Events API could also be implemented with business logic on Mollie&rsquo;s side. The setting will create a filtering on organisation or profile level for events listed when the merchant calls the events API.</p></li><li><p><em>Webhook sent to multiple addresses:</em>
Creating the possibility to set up multiple webhooks is important. Here it is also important to add the possibility for the customer to manually set up webhooks or within the connect flow of a new integration to set up a new webhook for certain needed events.</p></li></ol><p>It should be noted that simply accepting multiple values will not work as there will be scenarios where software A would create the payments/customers etc. but software B would be pulling the data and would need the updates. Software A should not be responsible for creating the callback to software B.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-01-19</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/multiple-webhook-urls-in-one-payment-or-order/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://idaikt.sporkify.net/multiple-webhook-urls-in-one-payment-or-order/ data-title="Multiple Webhook Urls in One Payment or Order" data-via=fbender><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://idaikt.sporkify.net/multiple-webhook-urls-in-one-payment-or-order/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://idaikt.sporkify.net/multiple-webhook-urls-in-one-payment-or-order/ data-title="Multiple Webhook Urls in One Payment or Order"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://idaikt.sporkify.net/multiple-webhook-urls-in-one-payment-or-order/ data-title="Multiple Webhook Urls in One Payment or Order"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://idaikt.sporkify.net/multiple-webhook-urls-in-one-payment-or-order/ data-title="Multiple Webhook Urls in One Payment or Order"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/replay-failed-webhook-calls/ class=prev rel=prev title="Replay Failed Webhook Calls"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Replay Failed Webhook Calls</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>This information may be inaccurate, out of date, or plainly wrong. This is not an official Mollie website. Please contact Mollie Support if you are unsure. || <a rel="external nofollow noreffer" href=https://fbender.de/contact>Imprint</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2021 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Florian Bender</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>